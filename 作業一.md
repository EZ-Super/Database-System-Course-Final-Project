# 題目 ： 全方位電商平台智慧型資料庫系統

# 應用情境與使用案例 ：

* 張小姐利用電腦訪問網站，並註冊一個新帳號。
* 完成信箱驗證後，登入平台並開始瀏覽首頁上的商品。
* 之後在搜尋欄輸入「保濕乳液」，系統根據關鍵字呈現多種商品，並顯示最近的熱銷排行榜。
* 她點選一款產品，查看詳細介紹，並將商品加入購物車。
* 結帳時，選擇儲存的地址並使用優惠券，完成線上付款。
* 付款完成後，平台發送通知給張小姐與通知賣家處理訂單。
* 賣家在看到新訂單通知，進行出貨作業，而系統隨後追蹤物流狀態並持續更新張小姐的訂單進度。



# 系統需求說明：
## 使用者角色
* 買家：註冊、搜尋商品、下單、付款、評價
* 賣家：註冊、上架商品、管理訂單、回覆評價
* 管理員：審核賣家、處理糾紛、管理平台內容
* 用戶帳號系統
* 商品瀏覽與搜尋
* 購物車與結帳流程
* 訂單追蹤
* 即時訊息系統
* 評價與留言系統
* 管理後台（審核商品、管理會員）
* JWT Token 金鑰登入管理
* 價格走勢

## 帳號系統
* 使用者可註冊帳號並驗證電子郵件/手機號碼
* 使用者可設定角色（買家/賣家）

## 商品上架與管理
* 賣家可以新增、編輯、刪除商品
* 商品需包含：名稱、描述、圖片、價格、庫存數量

## 購物流程
* 買家可將商品加入購物車
* 結帳需選擇配送地址與付款方式
* 系統發送訂單通知
 
## 評價系統
* 購買完成後可對賣家與商品評分
* 可留文字評論與圖片
 
## 使用者認證與權限驗證
* 使用者登入後，伺服器回傳 JWT Token（含 Access 與 Refresh Token）
* 所有需要登入權限的操作（如新增商品、下單）均需在 Header 中帶入 Access Token
* Token 逾時後可透過 Refresh Token 自動更新
* 管理員角色驗證以 JWT 中的角色欄位為依據
 
## 價格走勢分析
* 查看某商品歷史價格變化（可針對單一商品或類別分析）
* 支援比較同類型商品的價格趨勢 安全性
* 使用 HTTPS 通訊協定
* 密碼加密存儲（如 bcrypt）
* 防止 SQL injection、XSS 攻擊等
* JWT 認證機制
	* Token 有效期限：Access Token 有效 3小時
	* 防止 CSRF：Token 儲存於 HttpOnly cookie 時須實作 CSRF 保護策略
	* JWT 採 RSA私鑰加密，公鑰對於竄改進行驗證
 
# 完整性限制：
 
## 主鍵限制（Primary Key Constraint）
* 每一個表格都應有唯一的主鍵（如 user_id、product_id）
* 主鍵不可為 NULL，不可重複
 
## 外鍵限制（Foreign Key Constraint）
* 表格之間的關聯應透過外鍵實現，例如：
* orders.user_id 必須參照 users.user_id
* product_reviews.product_id 必須參照 products.product_id
* 刪除或修改參照資料時應定義對應行為（如：CASCADE、RESTRICT）
 
## 唯一性限制（Unique Constraint）
* 某些欄位必須全系統唯一，例如：
* 使用者的 email、帳號名稱不可重複
 
## 非空限制（NOT NULL Constraint）
* 必填欄位不得為 NULL，例如：
* 商品名稱、價格、數量、訂單狀態
 
## 資料型別限制（Data Type Constraint）
* 價格欄位應為 decimal，數量欄位應為正整數
* 日期欄位應限定為有效格式（ex: ISO 8601）
 
## 檢查限制（CHECK Constraint）
* 某些欄位的值需落在特定範圍：
* 商品價格必須大於 0
* 評價分數為 1~10 分之間
* 訂單狀態為 ENUM('待付款', '已出貨', '已完成', '已取消')
* 對於JWT token 金鑰過期以及竄改檢測
 
## 業務邏輯限制（Business Rule Constraints）
* 評價限制
	* 同一位買家只能對同一筆訂單留一次評價
	* 未完成訂單不能回評
	* 下單限制
	* 不得對已下架商品下單
	* 商品庫存不足時不可結帳
	* 單一訂單金額不得超過 NT$100,000
## 業務邏輯限制（Business Rule Constraints）
* 出貨限制
	* 超過 7 天未出貨自動通知賣家
	* 無法修改已出貨之訂單內容
	* 優惠限制
	* 優惠券不得與其他折扣疊加
	* 優惠券使用次數限制
 
## 業務邏輯限制（Business Rule Constraints）
* 上架限制
* 商品名稱不得超過 100 字元
* 商品描述不得含有禁用關鍵字
* 帳號限制
* 連續登入錯誤 5 次帳號自動鎖定 30 分鐘
* 被檢舉超過 5 次的賣家將暫停上架權限
* 停用帳號不得進行任何操作
 
## 業務邏輯限制（Business Rule Constraints）
* 通知機制
* 買家下單後系統須即時發送通知給賣家
* 訂單領貨後 3 天未點收，系統自動標示「已送達」










